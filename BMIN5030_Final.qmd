---
title: "Trends in Human Papillomavirus (HPV) Vaccination in the United States, 2013-2023"
subtitle: "BMIN 5030 Final Project"
author: "Lee Krobock"
format: 
  html:
    toc: true
    toc-location: left
editor: visual
number-sections: false
embed-resources: true
---

------------------------------------------------------------------------

## Overview {#sec-overview}

A relatively recent development in preventative medicine, the human papillomavirus (HPV) vaccine confers immunity to multiple oncogenic strains of HPV.  Studies have demonstrated decreased risks of head, neck, and cervical cancers, and cervical dysplasia in vaccinated individuals.^1^  Despite this, HPV vaccination has proven to be a challenging task in practice, with multiple changes to vaccine recommendations since its initial release and notable vaccine hesitancy, particularly early in its history and among parents of children and adolescents.  The goal of this project is to analyze questionnaire data from the National Health and Nutrition Examination Survey (NHANES) from 2013 to 2023 to describe trends in HPV vaccine coverage and vaccination practices in the United States.

[Final Project GitHub repository](https://github.com/lkrobock/BMIN-5030-Final-Project)

## Introduction {#sec-introduction}

The first vaccine against human papillomavirus, Gardasil 4vHPV, was licensed for use by the U.S. Food and Drug Administration (FDA) in June 2006, followed by official recommendations for use by the Advisory Committee on Immunization Practices (ACIP) published in March 2007.^2^ This quadrivalent vaccine provided protection against four strains of HPV and was initially recommended only for female patients between the ages of 9 and 26 years.^2^ Subsequently, in 2010, these recommendations were expanded to include males between ages 9 and 26.^3^ Following the 2015 FDA approval of a nonavalent HPV vaccine, which provided protection against an additional five disease-associated strains, the ACIP updated its recommendations to consider two appropriately-timed doses of HPV vaccine to be a completed series in patients who received the first dose between ages 9 and 14.^4^ The most recent update to HPV immunization guidelines recommends “shared clinical decision-making” to guide vaccination in adults between ages 27 and 45 years old, and notes that HPV vaccines are not licensed for use in adults over age 45.^5^

There are significant and well-described benefits to HPV vaccination– studies have demonstrated decreased risk of strain-specific HPV infection and associated growths, dysplasias, and cancers.^1,6^ Furthermore, Ellingson et al. noted in their systematic review that multiple studies suggest increased vaccine effectiveness with younger patient age at vaccination.^6^ In practice, however, clinicians have encountered challenges in implementing HPV vaccination as a standard preventative care practice.  For this project, I spoke with five family medicine and primary care clinicians to better understand their experiences in practice with HPV vaccination. In addition to slow shifts in practice following official recommendations and guideline updates, providers describe patient hesitancy early in the history of the HPV vaccine, related to potential side effects, adverse effects, and concerns about children and adolescents becoming sexually active earlier following vaccination.  In one clinician’s experience, it was not until the link between HPV and cancer became more widely understood by the public and HPV vaccination was marketed toward adults in addition to pediatric patients that it gained traction with the public.

Preventative healthcare, including immunization, is an interdisciplinary pursuit that requires insight and participation from clinicians, health educators, epidemiologists and public health researchers, medical and industry researchers, policymakers, and patient stakeholders.  By analyzing the data, I hope to identify and describe changes in HPV vaccination practices that may inform ongoing efforts in health promotion and preventative care.

## Methods {#sec-methods}

As discussed in this course, the National Health and Nutrition Examination Survey, or NHANES, is a multimodal study program initially conducted by the Centers for Disease Control (CDC) in the early 1960s, intended to provide nationally-representative data on health and nutrition in the United States. Over the past 25 years, the NHANES program evolved into an annual study consisting of health and dietary questionnaires, physical examinations, and laboratory testing. Data is typically reported in two year cycles, during which approximately 5,000 subjects are examined. Sampling and weighting procedures are designed and reviewed with each data cycle so the NHANES captures information that can be considered representative of the entire United States.

The NHANES program was suspended from March 2020 to August 2021 due to the COVID-19 pandemic. Its resumption in 2021 was marked by changes in sampling and study design to mitigate the ongoing spread of COVID-19, and decreased response rates consistent with trends described among other large scale U.S. surveys and studies.^7^ The most recently published NHANES datasets available to the public are from this first post-pandemic survey cycle, conducted from 2021 to 2023.

In 2024, the nhanesA R package was published, providing a means to directly import, search, and review data stored on the CDC's NHANES website in RStudio. Otherwise, NHANES data is stored digitally in SAS transport format files and can be viewed and converted to other formats using the SAS Universal Viewer program.^8^

### Loading required R packages

```{r}

library(tidyverse)  #dplyr, readr, ggplot2, stringr + tibble, tidyr
library(nhanesA)
library(gtsummary)
library(scales)
library(cowplot)
library(paletteer)
library(viridis)

```

### Loading NHANES demographics datasets

```{r}

nhanes2013d <- nhanes('DEMO_H')
nhanes2015d <- nhanes('DEMO_I')
nhanes2017d <- nhanes('P_DEMO') 

# Note: Naming convention for 2017-2020 combined, nationally representative pre-pandemic data 'P_filename' differs from the naming format of other data sets.

nhanes2021d <- nhanes('DEMO_L')

```

### Demographics data cleaning and processing

```{r}

nhanes2013demo <- mutate(nhanes2013d, DataCycle = "2013-2014",
  DataCycle = factor(DataCycle)) |>
  rename(ID = SEQN, Gender = RIAGENDR, Age = RIDAGEYR) |> 
  mutate(nhanes2013d, EligibleSubject = case_when(
    Age >= 9 & Age <= 59 ~ "Eligible",
    Age < 9 | Age > 59 ~ "Ineligible"), 
  EligibleSubject = factor(EligibleSubject)) |>
  select(DataCycle, ID, Gender, Age, EligibleSubject)

# Added a DataCycle variable to identify NHANES cycle year within the dataframe and an EligibleSubject variable to identify subjects in the eligible population sample for the immunization questionnaire.  

# Renamed variables and selected only variables of interest plus subject ID

nhanes2015demo <- mutate(nhanes2015d, DataCycle = "2015-2016",
  DataCycle = factor(DataCycle)) |>
  rename(ID = SEQN, Gender = RIAGENDR, Age = RIDAGEYR) |> 
  mutate(nhanes2015d, EligibleSubject = case_when(
    Age >= 9 & Age <= 59 ~ "Eligible",
    Age < 9 | Age > 59 ~ "Ineligible"), 
  EligibleSubject = factor(EligibleSubject)) |>
  select(DataCycle, ID, Gender, Age, EligibleSubject)

nhanes2017demo <- mutate(nhanes2017d, DataCycle = "2017-2020",
  DataCycle = factor(DataCycle)) |>
  rename(ID = SEQN, Gender = RIAGENDR, Age = RIDAGEYR) |> 
  mutate(nhanes2017d, EligibleSubject = case_when(
    Age >= 9 & Age <= 59 ~ "Eligible",
    Age < 9 | Age > 59 ~ "Ineligible"), 
  EligibleSubject = factor(EligibleSubject)) |>
  select(DataCycle, ID, Gender, Age, EligibleSubject)

# Note: Immunization questionnaire eligiblity changed in the most recent NHANES cycle-- only subjects between ages 9 and 49 were asked about HPV vaccination.  The Results section will examine findings from the 49-59 year old age group in previous cycles.

nhanes2021demo <- mutate(nhanes2021d, DataCycle = "2021-2023",
  DataCycle = factor(DataCycle)) |>
  rename(ID = SEQN, Gender = RIAGENDR, Age = RIDAGEYR) |> 
  mutate(nhanes2021d, EligibleSubject = case_when(
    Age >= 9 & Age <= 49 ~ "Eligible",
    Age < 9 | Age > 49 ~ "Ineligible"), 
  EligibleSubject = factor(EligibleSubject)) |>
  select(DataCycle, ID, Gender, Age, EligibleSubject)

nhanes_demos <- rbind(nhanes2013demo, nhanes2015demo, nhanes2017demo, nhanes2021demo)

# Created one dataframe to contain the selected demographic data from all four data cycles.

```

### Loading NHANES immunization questionnaire datasets

```{r}

nhanes2013i <- nhanes('IMQ_H')
nhanes2015i <- nhanes('IMQ_I')
nhanes2017i <- nhanes('P_IMQ')

# Note: Again, naming convention 'P_filename' for 2017-2020 combined, nationally representative pre-pandemic data differs from the naming format of other data sets.

nhanes2021i <- nhanes('IMQ_L')

```

### Immunization questionnaire data cleaning and processing

```{r}

# For each individual NHANES data cycle:

nhanes2013imm <- nhanes2013i |>
  rename(ID = SEQN,
         AnyHPVFemales = IMQ040,
         AnyHPVMales = IMQ070,
         FirstDoseAge = IMQ090,
         TotalShots = IMQ045) |>
  mutate(AnyHPVShots = case_when(
  (AnyHPVFemales == "Yes" | AnyHPVMales == "Yes") ~ "Yes",
  (AnyHPVFemales == "No" | AnyHPVMales == "No") ~ "No"),
  AnyHPVShots = factor(AnyHPVShots)) |>
  mutate(HPVComplete = case_when((FirstDoseAge >= 9 & TotalShots == "3 Doses") |
  (FirstDoseAge >= 9 & FirstDoseAge <= 14 & TotalShots == "2 Doses") ~ "Complete",
  (FirstDoseAge > 14 & FirstDoseAge <= 59 & TotalShots == "2 Doses") |
  (FirstDoseAge >= 9 | FirstDoseAge == 999  & (TotalShots == "1 Dose")) ~ "Incomplete", 
   (TotalShots == "Don't know" | TotalShots == "Refused") ~ "Unknown"),
  HPVComplete = factor(HPVComplete)) |>
  select(ID, AnyHPVFemales, AnyHPVMales, AnyHPVShots, FirstDoseAge, TotalShots, HPVComplete) 

nhanes2015imm <- nhanes2015i |> 
  rename(ID = SEQN, 
         AnyHPVFemales = IMQ060, 
         AnyHPVMales = IMQ070, 
         FirstDoseAge = IMQ090,
         TotalShots = IMQ100) |>
  mutate(AnyHPVShots = case_when(
  (AnyHPVFemales == "Yes" | AnyHPVMales == "Yes") ~ "Yes",
  (AnyHPVFemales == "No" | AnyHPVMales == "No") ~ "No"),
  AnyHPVShots = factor(AnyHPVShots)) |>
  mutate(HPVComplete = case_when((FirstDoseAge >= 9 & TotalShots == "3 Doses") |
  (FirstDoseAge >= 9 & FirstDoseAge <= 14 & TotalShots == "2 Doses") ~ "Complete",
  (FirstDoseAge > 14 & FirstDoseAge <= 59 & TotalShots == "2 Doses") |
  (FirstDoseAge >= 9 | FirstDoseAge == 999  & (TotalShots == "1 Dose")) ~ "Incomplete", 
   (TotalShots == "Don't know" | TotalShots == "Refused") ~ "Unknown"),
  HPVComplete = factor(HPVComplete)) |>
  select(ID, AnyHPVFemales, AnyHPVMales, AnyHPVShots, FirstDoseAge, TotalShots, HPVComplete) 

nhanes2017imm <- nhanes2017i |>
  rename(ID = SEQN, 
         AnyHPVFemales = IMQ060, 
         AnyHPVMales = IMQ070, 
         FirstDoseAge = IMQ090,
         TotalShots = IMQ100) |>
  mutate(AnyHPVShots = case_when(
  (AnyHPVFemales == "Yes" | AnyHPVMales == "Yes") ~ "Yes",
  (AnyHPVFemales == "No" | AnyHPVMales == "No") ~ "No"),
  AnyHPVShots = factor(AnyHPVShots)) |>
  mutate(HPVComplete = case_when((FirstDoseAge >= 9 & TotalShots == "3 Doses") |
  (FirstDoseAge >= 9 & FirstDoseAge <= 14 & TotalShots == "2 Doses") ~ "Complete",
  (FirstDoseAge > 14 & FirstDoseAge <= 59 & TotalShots == "2 Doses") |
  (FirstDoseAge >= 9 | FirstDoseAge == 999  & (TotalShots == "1 Dose")) ~ "Incomplete", 
   (TotalShots == "Don't know" | TotalShots == "Refused") ~ "Unknown"),
  HPVComplete = factor(HPVComplete)) |>
  select(ID, AnyHPVFemales, AnyHPVMales, AnyHPVShots, FirstDoseAge, TotalShots, HPVComplete) 

nhanes2021imm <- nhanes2021i |>
  rename(ID = SEQN, 
         AnyHPVFemales = IMQ060, 
         AnyHPVMales = IMQ070, 
         FirstDoseAge = IMQ090,
         TotalShots = IMQ100) |>
  mutate(AnyHPVShots = case_when(
  (AnyHPVFemales == "Yes" | AnyHPVMales == "Yes") ~ "Yes",
  (AnyHPVFemales == "No" | AnyHPVMales == "No") ~ "No"),
  AnyHPVShots = factor(AnyHPVShots)) |>
  mutate(HPVComplete = case_when((FirstDoseAge >= 9 & TotalShots == "3 Doses") |
  (FirstDoseAge >= 9 & FirstDoseAge <= 14 & TotalShots == "2 Doses") ~ "Complete",
  (FirstDoseAge > 14 & FirstDoseAge <= 59 & TotalShots == "2 Doses") |
  (FirstDoseAge >= 9 | FirstDoseAge == 999  & (TotalShots == "1 Dose")) ~ "Incomplete", 
   (TotalShots == "Don't know" | TotalShots == "Refused") ~ "Unknown"),
  HPVComplete = factor(HPVComplete)) |>
  select(ID, AnyHPVFemales, AnyHPVMales, AnyHPVShots, FirstDoseAge, TotalShots, HPVComplete)

# Created a "combined" variable for any HPV vaccines received across sex groups

# Additionally created a variable using age at first shot and number of shots received to determine if subject has received a complete HPV vaccine series by current standard of 3 shots or 2 shots if first received before age 15.  Unknown or refused total number of shots recoded to unknown status.

# Renamed variables and selected only variables of interest plus subject ID.

# Note: IMQ questionnaire items are the same but with different IDs in the 2013-2014 dataset.

nhanes_imms <- rbind(nhanes2013imm, nhanes2015imm, nhanes2017imm, nhanes2021imm)

# Created one dataframe to contain the selected demographic data from all four data cycles.

```

### Creating joined demographics and immunization datasets

```{r}

nhanes2013 <- left_join(nhanes2013demo, nhanes2013imm, by = c("ID"))
nhanes2015 <- left_join(nhanes2015demo, nhanes2015imm, by = c("ID"))
nhanes2017 <- left_join(nhanes2017demo, nhanes2017imm, by = c("ID"))
nhanes2021 <- left_join(nhanes2021demo, nhanes2021imm, by = c("ID"))

nhanes_all <- rbind(nhanes2013, nhanes2015, nhanes2017, nhanes2021)

# Created combined demographics and immunization questionnaire datasets for each NHANES cycle, and one dataset containing all data cycles.

nhanes_hpv_eligible <- filter(nhanes_all, EligibleSubject == "Eligible")

# Created a dataset specifically for subjects meeting HPV vaccine questionnaire eligibility, i.e. age 9-59 in pre-pandemic datasets and age 9-49 in post-pandemic dataset.

```

## Results {#sec-results}

### Reviewing participant demographics

```{r}

demos_summary <- nhanes_demos |>
  select(DataCycle, Gender, Age, EligibleSubject) |>
  tbl_summary(by = DataCycle) |>
  modify_caption("**Table 1: NHANES Subject Demographics**") |>
  bold_labels()
demos_summary

hpvdemos_summary <- nhanes_hpv_eligible |>
  select(DataCycle, Gender, Age) |>
  tbl_summary(by = DataCycle) |>
  modify_caption("**Table 2: Demographics of HPV Vaccine Questionnaire Subjects**") |>
  bold_labels()
hpvdemos_summary

# Created separate statistical summaries to describe overall NHANES subject demographics for each data cycle and demographics for subjects asked about HPV vaccination.

```

As seen in the demographics tables above, the subject demographics for the comprehensive NHANES dataset have remained fairly consistent over the past 10 years, in keeping with the goal of obtaining and analyzing nationally-representative information. There is a larger number of subjects in the 2017-2020 data cycle– due to its suspension during the COVID-19 pandemic, the NHANES program has combined the data collected in the 2017-2018 cycle with what was collected in 2019 and 2020 prior to the pandemic. This has enabled NHANES to create and report on a nationally-representative dataset, as opposed to the incomplete data from the 2019-2020 cycle.

Of note, there is a shift in the split between "eligible" and "ineligible" subjects for HPV vaccination data collection in the 2021-2023 NHANES cycle. This cycle featured the exclusion of subjects age 50 to 59, who were included in the three previous datasets– combined with older median and first/third quartile subject ages in this cycle, the total number of subjects who were assessed for HPV vaccination is less than in the three previous data cycles.

#### Consideration #1: Subjects between ages 49 and 59 who reported HPV vaccination

```{r}

cutoffsubjects <- filter(nhanes_all, Age > 49 & Age < 59 & (AnyHPVFemales == "Yes" | AnyHPVMales == "Yes"))

results1count1 <- count(cutoffsubjects, DataCycle, name = 'LateVaccineHistory')
results1count2 <- count(nhanes_hpv_eligible, DataCycle, name = 'EligibleSubjects')

cons1stats <- left_join(results1count1, results1count2) |>
  mutate(Proportion = ((LateVaccineHistory)/(EligibleSubjects)))
head(cons1stats)

# Created data frame to capture subjects reporting HPV vaccination between ages 49-59; subsequently created table to describe this population and proportions per data cycle.

```

In the first three NHANES data cycles analyzed in this project, subjects ages 49-59 who reported previous HPV vaccination only comprised between 0.1% and 0.3% of the total eligible subject population. This age group is excluded from HPV vaccination questionnaire data in the 2021-2023 NHANES.

#### Consideration #2: Subjects reporting HPV vaccination prior to age 9

```{r}

earlyhpvsubjects <- filter(nhanes_all, FirstDoseAge < 9)

results2count1 <- count(earlyhpvsubjects, DataCycle, name = 'EarlyVaccine')
cons2stats <- left_join(results2count1, results1count2) |>
  mutate(Proportion = ((EarlyVaccine)/(EligibleSubjects)))
head(cons2stats)

# Created data frame to capture subjects reporting first dose prior to age 9; subsequently created table to describe this population and proportions per data cycle.

```

While another relatively small group– comprising between approximately 0.1% and 0.7% of the total eligible subject population for each NHANES cycle– individuals reporting initial HPV vaccination before age 9 pose a challenge to data analysis. There is very little information available about HPV immunization in children under 9, and although earlier immunization is generally preferable, current guidelines indicate age 9 as the earliest approved age for HPV vaccination.

It is possible that some immunization questionnaire responses were incorrect– especially in cases where the first HPV dose age was reported as age 1 or 2, as hepatitis B (HBV) vaccination is typically completed in the first year of life. Although small and potentially more reflective of data inaccuracy, the proportion of early-vaccinated HPV subjects continuously increased over the past four NHANES cycles, and is worth further monitoring in future years.

### Question #1: Any HPV Vaccination

```{r}

allhpvsubjects <- filter(nhanes_hpv_eligible, AnyHPVShots == "Yes")
q1count1 <- count(allhpvsubjects, DataCycle, name = 'VaccinatedSubjects')
q1stats <- left_join(q1count1, results1count2) |>
  mutate(Proportion = ((VaccinatedSubjects)/(EligibleSubjects)))
head(q1stats)

q1summary <- nhanes_hpv_eligible |>
  select(DataCycle, Gender, AnyHPVFemales, AnyHPVMales) |>
  tbl_summary(by = DataCycle) |>
  remove_row_type(variables = c(AnyHPVFemales, AnyHPVMales), 
                  type = "missing") |>
  modify_caption("**Question #1: Have you ever received one or more doses of HPV vaccine?**") |>
  bold_labels()
q1summary

# Created q1stats table to display proportions of patients reporting yes/no/unknown HPV vaccination personal history; created q1summary statistical summary to review question #1 data.

```

```{r}

hpvq1fem1 <- ggplot(data=subset(nhanes_hpv_eligible, !is.na(AnyHPVFemales)), 
  aes(x = DataCycle, fill = AnyHPVFemales)) + 
  geom_bar() + 
  labs(title = "HPV Vaccination, Female (Totals)") +
  labs(x = "NHANES Data Cycle", y = "Number of subjects") +
  theme(title = element_text(size = 10), 
        axis.text.x = element_text(angle = 45, size= 7),
        legend.title = element_text(size = 7), 
        legend.text = element_text(size = 7)) +
  scale_fill_paletteer_d("ltc::ploen")
hpvq1fem2 <- ggplot(data=subset(nhanes_hpv_eligible, !is.na(AnyHPVFemales)), 
  aes(x = DataCycle, fill = AnyHPVFemales)) + 
  geom_bar(position = "fill") + 
  labs(title = "HPV Vaccination, Female (Proportions)") +
  labs(x = "NHANES Data Cycle", y = "Proportion of subjects") +
  scale_y_continuous(labels = percent) +
  theme(title = element_text(size = 10), 
        axis.text.x = element_text(angle = 45, size= 7),
        legend.title = element_text(size = 7), 
        legend.text = element_text(size = 7)) +
  scale_fill_paletteer_d("ltc::ploen")
plot_grid(hpvq1fem1, hpvq1fem2, label_size = 3)

hpvq1male1 <- ggplot(data=subset(nhanes_hpv_eligible, !is.na(AnyHPVMales)), 
  aes(x = DataCycle, fill = AnyHPVMales)) + 
  geom_bar() +
  labs(title = "HPV Vaccination, Male (Totals)") +
  labs(x = "NHANES Data Cycle", y = "Number of subjects") +
  theme(title = element_text(size = 10), 
        axis.text.x = element_text(angle = 45, size= 7),
        legend.title = element_text(size = 7), 
        legend.text = element_text(size = 7)) +
  scale_fill_paletteer_d("ltc::ploen")
hpvq1male2 <- ggplot(data=subset(nhanes_hpv_eligible, !is.na(AnyHPVMales)), 
  aes(x = DataCycle, fill = AnyHPVMales)) + 
  geom_bar(position = "fill") +
  labs(title = "HPV Vaccination, Male (Proportions)") +
  labs(x = "NHANES Data Cycle", y = "Proportion of subjects") +
  scale_y_continuous(labels = percent) +
  theme(title = element_text(size = 10), 
        axis.text.x = element_text(angle = 45, size= 7),
        legend.title = element_text(size = 7), 
        legend.text = element_text(size = 7)) +
  scale_fill_paletteer_d("ltc::ploen")
plot_grid(hpvq1male1, hpvq1male2, label_size = 5)

# Removed NAs and used original male/female split variables to capture distributions of answers by sex group.

# Created bar plots for data on history of HPV vaccination by data cycle; created separate plots to show total subject numbers and proportions.  Separated into side-by-side bar plots for gender groups.

```

```{r}

levels(nhanes_hpv_eligible$AnyHPVShots)
levels(nhanes2013$AnyHPVShots)
levels(nhanes2021$AnyHPVShots)

# Checked levels to confirm "Yes" answer to HPV vaccination history is the independent outcome being analyzed.

summary((glm(AnyHPVShots ~ Gender, data = nhanes2013, family = binomial())))
summary((glm(AnyHPVShots ~ Gender, data = nhanes2015, family = binomial())))
summary((glm(AnyHPVShots ~ Gender, data = nhanes2017, family = binomial())))
summary((glm(AnyHPVShots ~ Gender, data = nhanes2021, family = binomial())))

# Ran logistic regression models using combined variable as outcome and Gender as predictor; ran for each NHANES cycle individually.

```

Above, the response plots from the first HPV vaccination question depict larger total subject groups in the combined 2017-2020 pre-pandemic data cycle, and the fewest subjects asked about HPV vaccination in the most recent 2021-2023 cycle. The plots and dataframe both show linear increases over time in the proportion of male and female subjects reporting previous HPV vaccination.

Logistic regression models for vaccination as an outcome based on subject gender show statistically significant associations in each cycle with male gender and decreased odds of previous vaccination, and female gender and increased odds of previous vaccination. In reviewing these models, however, the difference between coefficients has progressively decreased since the 2013-2014 data cycle, suggesting less gender disparity over time.

### Question #2: Age at First HPV Vaccination

```{r}

unknownfirstdoseage <- filter(nhanes_hpv_eligible, FirstDoseAge == "999")
knownfirstdoseage <- filter(nhanes_hpv_eligible, FirstDoseAge != "999" & !is.na(FirstDoseAge))

# Created separate tables for patients with a known age at first HPV vaccine and patients who reported HPV vaccination but did not know age at first dose; important later to specifically separate out patients with unknown first dose age as the factor is coded as "999" numeric value.

q2count1 <- count(unknownfirstdoseage, DataCycle, name = 'UnknownAge')
q2count2 <- count(knownfirstdoseage, DataCycle, name = 'KnownAge')
q2stats <- results1count2 |>
  left_join(q1count1, by = 'DataCycle') |>
  left_join(q2count1, by = 'DataCycle') |>
  left_join(q2count2, by = 'DataCycle') |>
  mutate(UnknownProportion = (UnknownAge)/(VaccinatedSubjects)) |>
  mutate(KnownProportion = (KnownAge)/(VaccinatedSubjects)) 
head(q2stats)

q2summary <- nhanes_hpv_eligible |>
  select(DataCycle, Gender, FirstDoseAge) |>
  tbl_summary(by = DataCycle) |>
  remove_row_type(variables = c(FirstDoseAge), 
                  type = "missing") |>
  modify_caption("**Question #2: How old were you when you received your first dose of HPV vaccine?**") |>
  bold_labels()
q2summary

# Created q2stats table to display proportions of total, eligible, and vaccinated participants; created q2summary statistical summary to review question #2 data.

knownfirstdoseage |>
  group_by(Gender, DataCycle) |>
  summarize(AvgFirstHPVAge = mean(FirstDoseAge))

# Created summary of average first dose age for each gender group and data cycle.

```

```{r}

ggplot(knownfirstdoseage, aes(DataCycle, FirstDoseAge)) +
  geom_violin() + 
  geom_jitter(aes(color = FirstDoseAge), alpha = 0.5) +
  facet_grid(. ~ Gender) + 
  scale_color_viridis(option="turbo", limits=c(1,65)) +
  ylim(0, 60) +
  labs(title = "Age at First HPV Vaccination") +
  labs(x = "NHANES Data Cycle", y = "Age in years") + 
  theme(title = element_text(size = 10), 
        axis.text.x = element_text(angle = 45, size = 7),
        legend.title = element_text(size = 7), 
        legend.text = element_text(size = 7))

# Created violin/jitter plot to show side-by-side distributions of first HPV vaccine dose age by gender.

```

```{r}

levels(knownfirstdoseage$DataCycle)
levels(knownfirstdoseage$Gender)

# Checked levels to confirm data cycle 2013-2014 and male gender are intercept values.

summary((lm(FirstDoseAge ~ DataCycle, data = knownfirstdoseage)))
summary((lm(FirstDoseAge ~ Gender, data = knownfirstdoseage)))
summary((lm(FirstDoseAge ~ DataCycle + Gender, data = knownfirstdoseage)))

# Ran logistic regression models for HPV series completion as outcome and data cycle, gender, and combined data cycle/gender as predictors.

```

The dataframe above provides a breakdown between previously-vaccinated subjects who reported a known age at their first dose and those who were unsure of their age at first dose. Interestingly, the proportion of subjects who did not know the age at which they first received HPV vaccination continuously increased since the 2013-2014 cycle– initially about 9% of all vaccinated subjects, most recently up to 23%. Age at first dose is a valuable data component, as it not only provides insight into trends in vaccination timing, but also determines the number of vaccine doses required for a patient to be considered fully vaccinated. As such, the unavailability of this data could pose a challenge to eventual analysis of HPV vaccine series completion rates.

The violin plots depict similar visual distributions between gender groups, with the greatest density of first vaccine age between age 10 and 15 and consistent with guidelines encouraging HPV vaccination to start at age 11 or 12 to maximize efficacy. Since the 2013-2014 NHANES data cycle, there is an apparent increase in patients receiving their first vaccine prior to age 9 in both males and females. This is consistent with the continuous increase in the "very young" vaccine recipient population, noted earlier in consideration #2. Additionally, there appears to be a larger distribution overall of first dose age in females, with more female study participants having received their first HPV vaccine at a later age. The mean ages at first dose reported in the summary table is consistent with this, as it demonstrates older average ages for female participants in all but the 2013-2014 NHANES cycle.

In reviewing the linear regression models for data cycle, gender, and combined data cycle and gender as predictors of age at first dose, there is a non-linear association between the latter three data cycles and younger age at first dose versus the initial 2013-2014 data cycle; however, this association is not statistically significant. There is a borderline significant (p = 0.0506) relationship between female gender and older age at first dose. In the combined model, female gender is the only factor to remain statistically significant, and continues to be associated with older age at initial HPV vaccination. All of these findings are consistent with initial visual analysis of the data plots and statistical summaries, described above.

### Question #3: Total Number of HPV Vaccines Received

```{r}

q3count1 <- count(nhanes_all, DataCycle, name = 'TotalParticipants')

q3stats <- q3count1 |>
  left_join(results1count2, by = 'DataCycle') |>
  left_join(q1count1, by = 'DataCycle')
head(q3stats)

q3summary <- allhpvsubjects |>
  select(DataCycle, Gender, TotalShots, HPVComplete) |>
  tbl_summary(by = DataCycle) |>
  modify_caption("**Question #3: How many doses of the vaccine have you received?**") |>
  bold_labels()
q3summary

# Created q3stats table to display proportions of total, eligible, and vaccinated participants; created q3summary statistical summary to review question #3 data.

```

```{r}

ggplot(nhanes_hpv_eligible, aes(x = DataCycle, fill = TotalShots)) +
  geom_bar(position = "fill") + 
  labs(title = "Number of Vaccines Received, All Eligible Subjects") +
  labs(x = "NHANES Data Cycle", y = "Proportion of subjects") +
  scale_y_continuous(labels = percent) +
  theme(title = element_text(size = 10), 
        axis.text.x = element_text(angle = 45, size= 7),
        legend.title = element_text(size = 7), 
        legend.text = element_text(size = 7)) +
  scale_fill_paletteer_d("MetBrewer::Monet", direction = -1, na.value = 
  "darkgray") +
  facet_grid(. ~ Gender)

ggplot(data=subset(nhanes_hpv_eligible, !is.na(TotalShots)), aes(x = DataCycle, fill = TotalShots)) +
  geom_bar(position = "fill") + 
  labs(title = "Number of Vaccines Received, Vaccinated Subjects") +
  labs(x = "NHANES Data Cycle", y = "Proportion of subjects") +
  scale_y_continuous(labels = percent) +  
  theme(title = element_text(size = 10), 
        axis.text.x = element_text(angle = 45, size= 7),
        legend.title = element_text(size = 7), 
        legend.text = element_text(size = 7)) +
  scale_fill_paletteer_d("MetBrewer::Monet", direction = -1, na.value =   
  "darkgray") +
  facet_grid(. ~ Gender)

#Created two plots to show total number of vaccines received in the entire eligible population versus the vaccinated population-- this provides a visual to accompany the previous statistics summary table and emphasizes a relatively small vaccinated subject population.

ggplot(nhanes_hpv_eligible, aes(x = DataCycle, fill = HPVComplete)) +
  geom_bar(position = "fill") + 
  labs(title = "HPV Vaccine Series Completion, All Eligible Subjects") +
  labs(x = "NHANES Data Cycle", y = "Proportion of subjects") +
  scale_y_continuous(labels = percent) +
  theme(title = element_text(size = 10), 
        axis.text.x = element_text(angle = 45, size= 7),
        legend.title = element_text(size = 7), 
        legend.text = element_text(size = 7)) +
  scale_fill_paletteer_d("palettetown::poliwrath", na.value = "darkgray") +
  facet_grid(. ~ Gender)

ggplot(data=subset(nhanes_hpv_eligible, !is.na(TotalShots)), aes(x = DataCycle, fill = HPVComplete)) +
  geom_bar(position = "fill") + 
  labs(title = "HPV Vaccine Series Completion, Vaccinated Subjects") +
  labs(x = "NHANES Data Cycle", y = "Proportion of subjects") +
  scale_y_continuous(labels = percent) +
  theme(title = element_text(size = 10), 
        axis.text.x = element_text(angle = 45, size= 7),
        legend.title = element_text(size = 7), 
        legend.text = element_text(size = 7)) +
  scale_fill_paletteer_d("palettetown::poliwrath", na.value = "darkgray") +
  facet_grid(. ~ Gender)

#Created two plots again to show total number of vaccines received in the entire eligible population versus the vaccinated population.

```

```{r}

hpv_completeness <- filter(nhanes_hpv_eligible, HPVComplete == "Complete" |          HPVComplete == "Incomplete") |>
  droplevels()

# Created table specifically to run logistic regression on HPV series completion as a binary outcome.

levels(hpv_completeness$HPVComplete)
levels(hpv_completeness$DataCycle)
levels(hpv_completeness$Gender)

# Checked levels to confirm intercept values.

summary((glm(HPVComplete ~ DataCycle, data = hpv_completeness, family = binomial())))
summary((glm(HPVComplete ~ Gender, data = hpv_completeness, family = binomial())))
summary((glm(HPVComplete ~ DataCycle + Gender, data = hpv_completeness, family = binomial())))

# Ran logistic regression models for HPV series completion as outcome and data cycle, gender, and combined data cycle/gender as predictors.

```

The plots above reveal variation over the past four data cycles in the distribution of male and female subjects having previously received 1, 2, or 3 vaccines.  In 2021-2023, both groups demonstrated an increase in the number of subjects who received two doses, and a decrease in the number of those who received three doses.  At a glance, this could reflect the 2015 update in vaccination guidelines considering a two-dose series to be complete in patients who receive their first vaccine prior to age 15; if so, the proportion of participants with a history of complete HPV vaccination should also increase. However, the bar plots for complete versus incomplete vaccine series reveal a continuous drop in the proportion of subjects whose vaccination history is consistent with series completion, and a corresponding increase in those who report an incomplete series based on the number of vaccines received and age at first dose. The linear regression models for data cycle and gender as predictors of HPV series completion reveal statistically significant correlation between female gender and series completion, and between the three latter NHANES cycles and series non-completion. Additionally, this correlation between data cycle and complete HPV vaccination becomes stronger over time– the most recent 2021-2023 cycle has the most significant association with incomplete series.

Nonetheless, it is important to consider this data in the context of the larger eligible NHANES subject population. As shown in the plots for question #3 responses within the entire eligible subject cohort, the proportion of subjects reporting HPV vaccination consistently remains under 50%. As such, there are likely limitations to accuracy and the ability to make meaningful conclusions about trends in number of doses and vaccine series completion, given the relatively small size of this group.

## Conclusion

Analysis of the NHANES HPV vaccination data over the past 10 years yields several conclusions:

-   The proportion of individuals reporting any previous HPV vaccination has continuously increased for both gender groups since 2013.

-   Though male subjects continued to have higher odds than females of not having previously received HPV vaccination, the gender gap has progressively shrunk since 2013.

-   Visually, there is a wider distribution in age at first dose in female subjects, and a borderline statistically significant association between female gender and older first dose age. This is potentially consistent with HPV immunization often occurring as part of routine gynecologic care, an established preventative care practice that was reported when interviewing clinicians for this project.

-   Since 2013, there has been an increase in the percentage of subjects reporting initial vaccination prior to age 9, the recommended earliest age for vaccination.

-   Despite changes in HPV vaccine series completion guidelines, rates of vaccination completion have decreased since 2013, with the strongest association between incomplete vaccination and the 2021-2023 NHANES cycle. Though it does not completely explain the drop in completion rates in 2015-2016 and 2017-2020, one possibility is that this trend reflects disruptions to routine and preventative healthcare secondary to the COVID-19 pandemic, which could have interrupted series completion for individuals who already received one or two doses of the vaccine.

-   The proportion of subjects who reported not knowing their HPV vaccination history has continuously increased since 2013 across all three metrics (any vaccine history, age at first dose, and number of doses received.)

With these observations in mind, there are several recommendations for ongoing and future clinical practice, and efforts to increase HPV vaccination among all patients:

-   Continue efforts to promote HPV vaccination in pediatric, gynecologic, and adult primary care settings, including discussion of benefits and importance of vaccination regardless of sex or gender.

-   Further research into HPV-related outcomes in patients who receive their first HPV vaccine prior to age 9, in order to inform an official statement and recommendations from ACIP/CDC, as vaccination in patients younger than age 9 has increased over the past decade.

-   Prioritize efforts to complete follow-up care and to close gaps related to care disruption and incompleteness-- for example, missing and incomplete HPV vaccination due to COVID-19 related care disruption.

-   Encourage patients' access, knowledge, and understanding of personal health data, including immunization history. This has the potential to improve as electronic health records continue to become more comprehensive, interoperable, and accessible; however, ensuring that patients and providers alike have complete personal health information remains a challenge, especially with patients who access care at multiple practices and health systems.

HPV vaccination is a crucial preventative healthcare intervention with demonstrated efficacy against HPV and its serious complications, including cancer. By analyzing nationally-representative NHANES data from 2013 to 2023, we can better understand how vaccination practices and trends have evolved, and identify potential interventions to increase vaccination and series completion in all patients.

## Acknowledgements

I would like to thank Dr. Blanca Himes, Anastasia Lucas, and Jakob Woerner for their guidance and feedback in navigating R, RStudio, GitHub, and NHANES.

I would also like to thank Dr. Maria Pellecchia, Dr. Don Baag, Dr. Elaina Tully, Dr. Sig Larson, and John Laury CRNP for providing valuable insight into clinician experiences with HPV vaccination in the primary care and family medicine settings, which greatly contributed to understanding the context of this project's data and findings.

## References

1.  DeKloe, J., Urdang, Z. D., Martinez Outschoorn, U. E., & Curry, J. M. (2024). Effects of HPV vaccination on the development of HPV-related cancers: A retrospective analysis of a United States-based cohort.

2.  Centers for Disease Control and Prevention. *Quadrivalent Human Papillomavirus Vaccine: Recommendations of the Advisory Committee on Immunization Practices (ACIP)*. MMWR Early Release 2007;56(RR-12): 1–23.

3.  Centers for Disease Control and Prevention. *FDA Licensure of Quadrivalent Human Papillomavirus Vaccine (HPV4, Gardasil) for Use in Males and Guidance from the Advisory Committee on Immunization Practices (ACIP)*.  MMWR Morbidity and Mortality Weekly Report 2010;59(20): 630–632.

4.  Meites E, Kempe A, Markowitz LE. *Use of a 2-Dose Schedule for Human Papillomavirus Vaccination — Updated Recommendations of the Advisory Committee on Immunization Practices*. MMWR Morbidity and Mortality Weekly Report 2016;65: 1405–1408.

5.  Meites E, Szilagyi PG, Chesson HW, Unger ER, Romero JR, Markowitz LE. *Human Papillomavirus Vaccination for Adults: Updated Recommendations of the Advisory Committee on Immunization Practices*. MMWR Morbidity and Mortality Weekly Report 2019;68: 698–702.

6.  Ellingson, M. K., Sheikha, H., Nyhan, K., Oliveira, C. R., & Niccolai, L. M. (2023). Human papillomavirus vaccine effectiveness by age at vaccination: A systematic review. *Human vaccines & immunotherapeutics*, 19(2), 2239085.

7.  Centers for Disease Control and Prevention. (2024). *Brief overview of sample design, nonresponse bias assessment, and analytic guidelines for NHANES August 2021-August 2023*. Centers for Disease Control and Prevention. https://wwwn.cdc.gov/nchs/nhanes/continuousnhanes/overviewbrief.aspx?Cycle=2021-2023

8.  Centers for Disease Control and Prevention. (2024). *SAS Viewer*. Centers for Disease Control and Prevention. https://wwwn.cdc.gov/nchs/nhanes/SasViewer.aspx
